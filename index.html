<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Oasis Services PR — ¿Cómo se enteró de nosotros?</title>
<meta name="description" content="Formulario de origen de clientes — Oasis Services PR">
<style>
  :root{
    --bg:#0f0f12; --fg:#ffffff; --muted:#b7b7c3; --accent:#d4af37; --card:#171821; --field:#1f2230; --border:#2a2d40;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;background:var(--bg);color:var(--fg)}
  .wrap{max-width:760px;margin:32px auto;padding:24px}
  .card{background:var(--card);padding:24px 22px;border-radius:16px;box-shadow:0 8px 26px rgba(0,0,0,.35)}
  h1{margin:0 0 6px;font-size:24px}
  p.lead{margin:0 0 18px;color:var(--muted)}
  .row{display:flex;gap:14px;flex-wrap:wrap}
  .col{flex:1 1 260px}
  label{display:block;font-weight:600;margin:14px 0 8px}
  input,textarea{
    width:100%;background:var(--field);color:var(--fg);border:1px solid var(--border);
    border-radius:10px;padding:12px 14px;outline:none;transition:.2s;
  }
  input:focus,textarea:focus{border-color:var(--accent)}
  textarea{min-height:120px;resize:vertical}
  .hint{font-size:12px;color:var(--muted);margin-top:6px}
  .actions{margin-top:18px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  button{
    appearance:none;border:0;border-radius:10px;padding:12px 16px;font-weight:700;cursor:pointer;
    background:var(--accent);color:#000;min-width:160px
  }
  .ghost{background:transparent;border:1px solid var(--border);color:var(--fg);text-decoration:none;padding:12px 16px;border-radius:10px}
  .msg{margin-top:14px;font-weight:600}
  .ok{color:#79e17b}.err{color:#ff7777}
  footer{opacity:.75;margin-top:16px;font-size:12px}
  .req::after{content:" *";color:#ff7777;font-weight:800}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Oasis Services PR — ¿Cómo se enteró de nosotros?</h1>
      <p class="lead">Responde con tus palabras. ¡Gracias por ayudarnos a mejorar!</p>

      <form id="f" novalidate>
        <div class="row">
          <div class="col">
            <label class="req" for="nombre">Nombre</label>
            <input id="nombre" name="nombre" placeholder="Nombre y apellidos" required>
          </div>
          <div class="col">
            <label for="telefono">Teléfono</label>
            <input id="telefono" name="telefono" placeholder="787-000-0000">
          </div>
        </div>

        <label class="req" for="origen">¿Cómo se enteró de nosotros?</label>
        <input id="origen" name="origen" placeholder="Ej. Instagram, amigo, Google, flyer, guagua rotulada…" required>

        <label for="detalle">¿Qué vio exactamente o qué buscó?</label>
        <input id="detalle" name="detalle" placeholder="Ej. Reel de mantenimiento, búsqueda 'instalación mini split'…">

        <div class="row">
          <div class="col">
            <label for="ciudad">Ciudad / Área</label>
            <input id="ciudad" name="ciudad" placeholder="Ej. Trujillo Alto">
          </div>
          <div class="col">
            <label for="recomendado_por">Si fue recomendado: ¿quién lo recomendó?</label>
            <input id="recomendado_por" name="recomendado_por" placeholder="Nombre de la persona/cliente (opcional)">
          </div>
        </div>

        <label for="comentarios">Comentarios</label>
        <textarea id="comentarios" name="comentarios" placeholder="Algo que quiera contarnos (opcional)"></textarea>
        <div class="hint">Al enviar, autorizas que usemos esta información para mejorar nuestro servicio. No compartimos tus datos con terceros.</div>

        <div class="actions">
          <button id="sendBtn" type="submit">Enviar</button>
          <a class="ghost" id="share" href="#">Copiar link</a>
          <span id="msg" class="msg"></span>
        </div>
      </form>

      <footer>OasisServicesPR.com • 787-664-3079 • Trujillo Alto, PR</footer>
    </div>
  </div>

<script>
  // 1) Pega aquí la URL de tu Web App de Apps Script (paso 2)
  const SCRIPT_URL = "PEGAR_AQUI_TU_URL_WEBAPP"; // ejemplo: https://script.google.com/macros/s/AKfy.../exec

  // Utilidad: saneo básico de strings
  const clean = (s) => (s || "").toString().trim();

  // Copiar link
  document.getElementById('share').addEventListener('click', (e)=>{
    e.preventDefault();
    navigator.clipboard.writeText(window.location.href).then(()=>{
      e.target.textContent='¡Link copiado!';
      setTimeout(()=>e.target.textContent='Copiar link', 2000);
    });
  });

  // Envío
  const form = document.getElementById('f');
  const msg = document.getElementById('msg');
  const sendBtn = document.getElementById('sendBtn');

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    msg.textContent = '';
    msg.className = 'msg';

    // Validación mínima
    if(!form.nombre.value.trim() || !form.origen.value.trim()){
      msg.textContent = 'Completa los campos obligatorios (Nombre y ¿Cómo se enteró?).';
      msg.classList.add('err');
      return;
    }

    // Payload
    const payload = {
      nombre: clean(form.nombre.value),
      telefono: clean(form.telefono.value),
      origen: clean(form.origen.value),
      detalle: clean(form.detalle.value),
      ciudad: clean(form.ciudad.value),
      recomendado_por: clean(form.recomendado_por.value),
      comentarios: clean(form.comentarios.value),
      meta: {
        url: window.location.href,
        ref: document.referrer || '',
        ua: navigator.userAgent || ''
      }
    };

    // Enviar
    sendBtn.disabled = true; sendBtn.textContent = 'Enviando…';
    try{
      const res = await fetch(SCRIPT_URL, {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload),
        mode: 'cors',
        cache: 'no-store'
      });
      const data = await res.json();
      if(data && data.ok){
        msg.textContent = '¡Gracias! Respuesta enviada correctamente.';
        msg.classList.add('ok');
        form.reset();
      }else{
        throw new Error(data && data.error ? data.error : 'Error desconocido');
      }
    }catch(err){
      console.error(err);
      msg.textContent = 'No se pudo enviar. Verifica conexión o configura la URL del Web App.';
      msg.classList.add('err');
    }finally{
      sendBtn.disabled = false; sendBtn.textContent = 'Enviar';
    }
  });
</script>
</body>
</html>
